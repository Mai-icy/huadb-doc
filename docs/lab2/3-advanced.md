# 高级功能

## 任务 1：故障恢复中的异常处理（2 分）

### 实验描述

基础功能仅考虑到查询执行过程中的异常处理过程，高级功能要求在此基础上考虑到故障恢复过程中出现异常时的处理流程，需要引入补偿日志的机制来保证 Undo 过程异常恢复的正确性和执行效率。

### 实现思路

-   步骤 1：修改数据库故障恢复逻辑，在数据库故障恢复过程中随机发生故障。

-   步骤 2：理解课程中撤销阶段异常恢复的特殊性，理解补偿日志的机制。并在故障恢复算法中添加补偿日志的记录和处理能力。

## 任务 2：非阻塞检查点机制（1 分）

### 实验描述

基础功能中检查点日志按照阻塞的方式追加到磁盘，当 ATT 和 DPT 表容量较大时将影响到系统的查询处理运行，在高级功能中要求采用多线程的方式添加对于非阻塞检查点功能的支持。

### 实现思路

-   步骤 0：理解实验框架中阻塞检查点的信息记录方法，思考非阻塞检查点的信息记录方式。

-   步骤 1：修改 LogManager::Checkpoint 函数，修改 BeginCheckpointLog 和 EndCheckpointLog 的实现，确定 ATT 和 DPT 实际存储位置。

-   步骤 2：修改 LogManager 类，添加多线程检查点任务结束的异步通知机制，添加多线程情况下的检查点完成的处理函数。

{%
	include-markdown "common/advanced.md"
%}
